# MyGitFame

Консольная утилита для подсчёта статистик авторов git репозитория.

```
✗ go run main.go --repository=. --extensions='.go,.md' --order-by=lines
Name                    Lines Commits Files
Alexander_Kozhevnikov   507   2       2
AlexanderKozhevnikov672 1     1       1
```

### Статистики

* Количество строк
* Количество коммитов
* Количество файлов

Все статистики считаются для состояния репозитория на момент конкретного коммита.

### Интерфейс

Утилита печатает результат в stdout.

При использовании невалидного значения флага или любой другой ошибке программа завершается с ненулевым кодом возврата.

Прогресс печатается в stderr.

### Расчёт

Каждой строке интересующего подмножества файлов репозитория сопоставляется последний коммит, модифицировавший эту строку.
Пустым файлам сопоставляются последние менявшие их коммиты.

После этого для каждого уникального автора, получившегося множества коммитов, считается количество строк, уникальных коммитов и файлов, которые затрагивали коммиты автора.

В процессе работы скрипт не меняет состояние репозитория ни в какой момент, что позволяет параллельно работать с репозиторием.

### Флаги

Утилита поддерживает следующий набор флагов:

**--repository** — путь до Git репозитория; по умолчанию текущая директория

**--revision** — указатель на коммит; HEAD по умолчанию

**--order-by** — ключ сортировки результатов; один из `lines` (дефолт), `commits`, `files`.

По умолчанию результаты сортируются по убыванию ключа `(lines, commits, files)`.
При равенстве ключей выше будет автор с лексикографически меньшим именем.
При использовании флага соответствующее поле в ключе перемещается на первое место.

**--use-committer** — булев флаг, заменяющий в расчётах автора (дефолт) на коммиттера

**--format** — формат вывода; один из `tabular` (дефолт), `csv`, `json`, `json-lines`;

`tabular`:
```
Name                    Lines Commits Files
Alexander_Kozhevnikov   507   2       2
AlexanderKozhevnikov672 1     1       1
```

`csv`:
```
Name,Lines,Commits,Files
Alexander_Kozhevnikov,507,2,2
AlexanderKozhevnikov672,1,1,1
```

`json`:
```
[{"name":"Alexander_Kozhevnikov","commits":2,"lines":507,"files":2},{"name":"AlexanderKozhevnikov672","commits":1,"lines":1,"files":1}]
```

`json-lines`:
```
{"name":"Alexander_Kozhevnikov","commits":2,"lines":507,"files":2}
{"name":"AlexanderKozhevnikov672","commits":1,"lines":1,"files":1}
```

**--extensions** — список расширений, сужающий список файлов в расчёте; множество ограничений разделяется запятыми, например, `'.go,.md'`

**--languages** — список языков (программирования, разметки и др.), сужающий список файлов в расчёте; множество ограничений разделяется запятыми, например `'go,markdown'`

Неизвестные языки никаких ограничений не накладывают.

**--exclude** — набор [Glob](https://en.wikipedia.org/wiki/Glob_(programming)) паттернов, исключающих файлы из расчёта, например `'foo/*,bar/*'`

**--restrict-to** — набор Glob паттернов, исключающий все файлы, не удовлетворяющие ни одному из паттернов набора
